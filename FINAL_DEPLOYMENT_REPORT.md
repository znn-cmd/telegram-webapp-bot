# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Amvera

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–º–µ–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —É—Å–ø–µ—à–Ω–æ–º—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Amvera:

1. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
2. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
3. **–û—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤ –≤ –∫–æ–¥–µ**
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏**

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)**

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–∞–∫–µ—Ç—ã

```txt
flask==2.3.3
flask-cors==4.0.0
requests==2.31.0
python-dotenv==1.0.0
fpdf2==2.8.3
matplotlib==3.7.2
pillow==10.0.0
numpy==1.24.3
python-telegram-bot==13.15
openai==1.3.0
supabase==2.0.2          # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
kaleido==0.2.1           # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
python-dateutil==2.8.2   # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
```

### 2. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `SUPABASE_ANON_KEY`
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∞–ª–∞ `SUPABASE_KEY`

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–º–µ–Ω–∞ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```yaml
# amvera.yaml
env:
  - name: SUPABASE_ANON_KEY  # ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û
    value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

```env
# .env
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...  # ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û
```

### 3. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (amvera.yaml)**

**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è matplotlib
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```yaml
build:
  commands:
    - apt-get update && apt-get install -y libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev libgomp1  # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
    - pip install -r requirements.txt
```

### 4. **–û—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤ –≤ app.py**

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞–π–¥–µ–Ω—ã 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤

- –°—Ç—Ä–æ–∫–∞ 2663: `else:` ‚Üí `else:`
- –°—Ç—Ä–æ–∫–∞ 2858: `except:` ‚Üí `except:`
- –°—Ç—Ä–æ–∫–∞ 3229: `except:` ‚Üí `except:`
- –°—Ç—Ä–æ–∫–∞ 2093: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ –±–ª–æ–∫–µ `if trends_data:`

### 5. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏**

**–ü—Ä–æ–±–ª–µ–º–∞**: Google Maps API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Amvera
**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Nominatim API –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫

```python
# –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Nominatim API (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö)
try:
    nominatim_data = get_nominatim_location(address)
    if nominatim_data and nominatim_data.get('lat') and nominatim_data.get('lon'):
        return jsonify({
            'success': True,
            'lat': float(nominatim_data['lat']),
            'lng': float(nominatim_data['lon']),
            'formatted_address': nominatim_data.get('display_name', address),
            'source': 'nominatim'
        })
except Exception as e:
    logger.error(f"Nominatim geocoding error: {e}")

# Fallback –Ω–∞ Google Maps API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
try:
    logger.info("üîÑ –ü—Ä–æ–±—É–µ–º Google Maps API –∫–∞–∫ fallback...")
    response = requests.get(url, params=params, timeout=10)
    # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
except Exception as e:
    logger.error(f"Google Maps geocoding error: {e}")
    return jsonify({'error': 'All geocoding services are unavailable'}), 500
```

### 6. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

**–î–æ–±–∞–≤–ª–µ–Ω—ã**:
- –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (15 —Å–µ–∫ –¥–ª—è Nominatim, 10 —Å–µ–∫ –¥–ª—è Google Maps)
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫ (Timeout, ConnectionError)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

‚úÖ **–°–∏–Ω—Ç–∞–∫—Å–∏—Å Python –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω**
‚úÖ **–í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç**
‚úÖ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã**
‚úÖ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase —Ä–∞–±–æ—Ç–∞–µ—Ç**
‚úÖ **Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–∞**

## –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### amvera.yaml
```yaml
name: telegram-webapp-bot
runtime: python
version: "3.11"

build:
  commands:
    - apt-get update && apt-get install -y libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev libgomp1
    - pip install -r requirements.txt

run:
  command: python app.py
  port: 8080

env:
  - name: TELEGRAM_BOT_TOKEN
    value: 7215676549:AAFS86JbRCqwzTKQG-dF96JX-C1aWNvBoLo
  - name: SUPABASE_URL
    value: https://dzllnnohurlzjyabgsft.supabase.co
  - name: SUPABASE_ANON_KEY
    value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR6bGxubm9odXJsemp5YWJnc2Z0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5NDgwMjcsImV4cCI6MjA2NjUyNDAyN30.sJCIeeIm0Ye1JbAdw5HzfAMe8QLgQomArK8yoppuevQ
```

### requirements.txt
```txt
flask==2.3.3
flask-cors==4.0.0
requests==2.31.0
python-dotenv==1.0.0
fpdf2==2.8.3
matplotlib==3.7.2
pillow==10.0.0
numpy==1.24.3
python-telegram-bot==13.15
openai==1.3.0
supabase==2.0.2
kaleido==0.2.1
python-dateutil==2.8.2
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ Amvera**
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è**
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è**
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**: https://aaadviser.pro

## –°—Ç–∞—Ç—É—Å

üü¢ **–í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´**
üü¢ **–ü–†–ò–õ–û–ñ–ï–ù–ò–ï –ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ**
üü¢ **–°–ò–°–¢–ï–ú–ê –°–¢–ê–õ–ê –ë–û–õ–ï–ï –ù–ê–î–ï–ñ–ù–û–ô**

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ Amvera
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

**–î–∞—Ç–∞**: 07.08.2025  
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é  
**–í–µ—Ä—Å–∏—è**: 1.0
