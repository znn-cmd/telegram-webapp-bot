# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å —Å–µ—Ç–µ–≤—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–ª–æ –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Maps API:
```
HTTPSConnectionPool(host='maps.googleapis.com', port=443): Max retries exceeded with url: /maps/api/geocode/json?address=... (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fd5c78d1e10>: Failed to establish a new connection: [Errno 101] Network is unreachable'))
```

## –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–µ—Ç–∏ –Ω–∞ Amvera** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ `maps.googleapis.com`
2. **–í–æ–∑–º–æ–∂–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å DNS** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤** –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ –≤–Ω–µ—à–Ω–∏–º API

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Nominatim API –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è**

Nominatim API –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–µ–π:

```python
# –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Nominatim API (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö)
try:
    nominatim_data = get_nominatim_location(address)
    if nominatim_data and nominatim_data.get('lat') and nominatim_data.get('lon'):
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ Nominatim
        return jsonify({
            'success': True,
            'lat': float(nominatim_data['lat']),
            'lng': float(nominatim_data['lon']),
            'formatted_address': nominatim_data.get('display_name', address),
            'location_components': location_components,
            'location_codes': location_codes,
            'source': 'nominatim'
        })
```

### 2. **Google Maps API –∫–∞–∫ fallback**

Google Maps API —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:

```python
# Fallback –Ω–∞ Google Maps API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
try:
    logger.info("üîÑ –ü—Ä–æ–±—É–µ–º Google Maps API –∫–∞–∫ fallback...")
    response = requests.get(url, params=params, timeout=10)
    # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
except Exception as e:
    logger.error(f"Google Maps geocoding error: {e}")
    return jsonify({'error': 'All geocoding services are unavailable'}), 500
```

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ Nominatim API**

–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫:

```python
def get_nominatim_location(address):
    try:
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–∞–π–º–∞—É—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è
        response = requests.get(url, params=params, headers=headers, timeout=15)
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    except requests.exceptions.Timeout:
        logger.error(f"‚è∞ –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Nominatim API –¥–ª—è –∞–¥—Ä–µ—Å–∞: {address}")
        return None
    except requests.exceptions.ConnectionError as e:
        logger.error(f"üåê –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Nominatim API: {e}")
        return None
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ Nominatim API: {e}")
        return None
```

### 4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤**

–í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç —Ç–∞–π–º–∞—É—Ç—ã:
- Nominatim API: 15 —Å–µ–∫—É–Ω–¥
- Google Maps API: 10 —Å–µ–∫—É–Ω–¥

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- Nominatim API –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–µ–π
- –ú–µ–Ω—å—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚úÖ **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**
- –î–≤–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- Graceful fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–µ
- –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Nominatim
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

üü¢ **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Google Maps API —Ä–µ—à–µ–Ω–∞**
üü¢ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Nominatim**
üü¢ **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫**
üü¢ **–î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–ú–µ—Ç—Ä–∏–∫–∏**: –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ Nominatim vs Google Maps
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
4. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã**: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –≥–µ–æ–∫–æ–¥–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å—ã

## –°—Ç–∞—Ç—É—Å

üü¢ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**
üü¢ **–°–∏—Å—Ç–µ–º–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π**
üü¢ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞ Amvera**
