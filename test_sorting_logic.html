<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ç—Ä–µ–Ω–¥–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .result { background: #f0f8ff; padding: 10px; margin: 10px 0; border-radius: 3px; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .historical { background-color: #f9f9f9; }
        .current { background-color: #e8f4fd; }
        .future { background-color: #f0f8ff; }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ç—Ä–µ–Ω–¥–æ–≤</h1>
    <p><strong>–¶–µ–ª—å:</strong> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ ‚Üí –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü ‚Üí –ë—É–¥—É—â–∏–µ</p>
    
    <div class="test-section">
        <h2>–¢–µ—Å—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</h2>
        <button onclick="testSorting()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</button>
        <div id="sortingResult" class="result"></div>
    </div>

    <script>
        // –ò–º–∏—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥–æ–≤ (–∫–∞–∫ –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ)
        const mockTrends = [
            // –ë—É–¥—É—â–∏–µ –º–µ—Å—è—Ü—ã (2026)
            { date: '2026-06-01', property_year: 2026, property_month: 6, unit_price_for_sale: 71107, unit_price_for_rent: 355.43, type: 'future' },
            { date: '2026-05-01', property_year: 2026, property_month: 5, unit_price_for_sale: 69763, unit_price_for_rent: 347.95, type: 'future' },
            { date: '2026-04-01', property_year: 2026, property_month: 4, unit_price_for_sale: 68486, unit_price_for_rent: 342.95, type: 'future' },
            { date: '2026-03-01', property_year: 2026, property_month: 3, unit_price_for_sale: 67385, unit_price_for_rent: 339.32, type: 'future' },
            { date: '2026-02-01', property_year: 2026, property_month: 2, unit_price_for_sale: 66577, unit_price_for_rent: 335.06, type: 'future' },
            { date: '2026-01-01', property_year: 2026, property_month: 1, unit_price_for_sale: 65852, unit_price_for_rent: 331.43, type: 'future' },
            
            // –¢–µ–∫—É—â–∏–π –≥–æ–¥ (2025) - –±—É–¥—É—â–∏–µ –º–µ—Å—è—Ü—ã
            { date: '2025-12-01', property_year: 2025, property_month: 12, unit_price_for_sale: 64904, unit_price_for_rent: 327.45, type: 'future' },
            { date: '2025-11-01', property_year: 2025, property_month: 11, unit_price_for_sale: 64226, unit_price_for_rent: 322.12, type: 'future' },
            { date: '2025-10-01', property_year: 2025, property_month: 10, unit_price_for_sale: 63567, unit_price_for_rent: 316.58, type: 'future' },
            { date: '2025-09-01', property_year: 2025, property_month: 9, unit_price_for_sale: 62794, unit_price_for_rent: 310.37, type: 'future' },
            
            // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü (–∞–≤–≥—É—Å—Ç 2025)
            { date: '2025-08-01', property_year: 2025, property_month: 8, unit_price_for_sale: 65753, unit_price_for_rent: 328.00, type: 'current' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2024)
            { date: '2024-12-01', property_year: 2024, property_month: 12, unit_price_for_sale: 50484, unit_price_for_rent: 253.34, type: 'historical' },
            { date: '2024-11-01', property_year: 2024, property_month: 11, unit_price_for_sale: 49544, unit_price_for_rent: 246.13, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2023)
            { date: '2023-12-01', property_year: 2023, property_month: 12, unit_price_for_sale: 45000, unit_price_for_rent: 220.00, type: 'historical' },
            { date: '2023-06-01', property_year: 2023, property_month: 6, unit_price_for_sale: 42000, unit_price_for_rent: 200.00, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2022)
            { date: '2022-12-01', property_year: 2022, property_month: 12, unit_price_for_sale: 40000, unit_price_for_rent: 180.00, type: 'historical' },
            { date: '2022-06-01', property_year: 2022, property_month: 6, unit_price_for_sale: 38000, unit_price_for_rent: 170.00, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2021)
            { date: '2021-12-01', property_year: 2021, property_month: 12, unit_price_for_sale: 35000, unit_price_for_rent: 160.00, type: 'historical' },
            { date: '2021-06-01', property_year: 2021, property_month: 6, unit_price_for_sale: 33000, unit_price_for_rent: 150.00, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2020)
            { date: '2020-12-01', property_year: 2020, property_month: 12, unit_price_for_sale: 30000, unit_price_for_rent: 140.00, type: 'historical' },
            { date: '2020-06-01', property_year: 2020, property_month: 6, unit_price_for_sale: 28000, unit_price_for_rent: 130.00, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2019)
            { date: '2019-12-01', property_year: 2019, property_month: 12, unit_price_for_sale: 25000, unit_price_for_rent: 120.00, type: 'historical' },
            { date: '2019-06-01', property_year: 2019, property_month: 6, unit_price_for_sale: 23000, unit_price_for_rent: 110.00, type: 'historical' },
            
            // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2018)
            { date: '2018-12-01', property_year: 2018, property_month: 12, unit_price_for_sale: 20000, unit_price_for_rent: 100.00, type: 'historical' },
            { date: '2018-06-01', property_year: 2018, property_month: 6, unit_price_for_sale: 18000, unit_price_for_rent: 90.00, type: 'historical' }
        ];
        
        function testSorting() {
            const result = document.getElementById('sortingResult');
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1;
            
            console.log(`üîç Current date: ${currentYear}-${currentMonth}`);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ–≤—É—é –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            const sortedTrends = mockTrends.sort((a, b) => {
                if (a.property_year !== b.property_year) {
                    return b.property_year - a.property_year;
                }
                return b.property_month - a.property_month;
            });
            
            // –†–∞–∑–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥—ã –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const currentYearTrends = sortedTrends.filter(trend => trend.property_year === currentYear);
            const historicalTrends = sortedTrends.filter(trend => trend.property_year < currentYear);
            const futureTrends = sortedTrends.filter(trend => 
                trend.property_year > currentYear || 
                (trend.property_year === currentYear && trend.property_month > currentMonth)
            );
            
            // –î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞ –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏ 1 –º–µ—Å—è—Ü –≤–ø–µ—Ä–µ–¥
            const currentMonthTrends = currentYearTrends.filter(trend => 
                trend.property_month === currentMonth || trend.property_month === currentMonth + 1
            );
            
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —Ç—Ä–µ–Ω–¥—ã: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ + —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü + –±—É–¥—É—â–∏–µ
            const allTrends = [...historicalTrends, ...currentMonthTrends, ...futureTrends];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            allTrends.sort((a, b) => {
                const aYear = a.property_year;
                const bYear = b.property_year;
                const aMonth = a.property_month;
                const bMonth = b.property_month;
                
                // –ï—Å–ª–∏ –æ–±–∞ —Ç—Ä–µ–Ω–¥–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ (–ø—Ä–æ—à–ª—ã–µ –≥–æ–¥—ã)
                if (aYear < currentYear && bYear < currentYear) {
                    if (aYear !== bYear) {
                        return bYear - aYear; // –ù–æ–≤—ã–µ –≥–æ–¥—ã —Å–Ω–∞—á–∞–ª–∞
                    }
                    return bMonth - aMonth; // –ù–æ–≤—ã–µ –º–µ—Å—è—Ü—ã —Å–Ω–∞—á–∞–ª–∞
                }
                
                // –ï—Å–ª–∏ –æ–±–∞ —Ç—Ä–µ–Ω–¥–∞ –±—É–¥—É—â–∏–µ (–±—É–¥—É—â–∏–µ –≥–æ–¥—ã)
                if (aYear > currentYear && bYear > currentYear) {
                    if (aYear !== bYear) {
                        return aYear - bYear; // –°—Ç–∞—Ä—ã–µ –≥–æ–¥—ã —Å–Ω–∞—á–∞–ª–∞
                    }
                    return aMonth - bMonth; // –°—Ç–∞—Ä—ã–µ –º–µ—Å—è—Ü—ã —Å–Ω–∞—á–∞–ª–∞
                }
                
                // –ï—Å–ª–∏ –æ–¥–∏–Ω –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π, –∞ –¥—Ä—É–≥–æ–π –±—É–¥—É—â–∏–π
                if (aYear < currentYear && bYear > currentYear) {
                    return -1; // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∏–¥–µ—Ç –ø–µ—Ä–≤—ã–º
                }
                if (aYear > currentYear && bYear < currentYear) {
                    return 1; // –ë—É–¥—É—â–∏–π –∏–¥–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º
                }
                
                // –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
                if (aYear === currentYear && bYear !== currentYear) {
                    if (bYear < currentYear) {
                        return 1; // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∏–¥–µ—Ç –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–∏–º
                    } else {
                        return -1; // –ë—É–¥—É—â–∏–π –∏–¥–µ—Ç –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ
                    }
                }
                if (bYear === currentYear && aYear !== currentYear) {
                    if (aYear < currentYear) {
                        return -1; // –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∏–¥–µ—Ç –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–∏–º
                    } else {
                        return 1; // –ë—É–¥—É—â–∏–π –∏–¥–µ—Ç –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ
                    }
                }
                
                // –ï—Å–ª–∏ –æ–±–∞ —Ç—Ä–µ–Ω–¥–∞ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
                if (aYear === currentYear && bYear === currentYear) {
                    if (aMonth === currentMonth && bMonth !== currentMonth) {
                        return -1; // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏–¥–µ—Ç –ø–µ—Ä–≤—ã–º
                    }
                    if (bMonth === currentMonth && aMonth !== currentMonth) {
                        return 1; // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏–¥–µ—Ç –ø–µ—Ä–≤—ã–º
                    }
                    if (aMonth === currentMonth + 1 && bMonth !== currentMonth + 1) {
                        return -1; // –°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü –∏–¥–µ—Ç –≤—Ç–æ—Ä—ã–º
                    }
                    if (bMonth === currentMonth + 1 && aMonth !== currentMonth + 1) {
                        return 1; // –°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü –∏–¥–µ—Ç –≤—Ç–æ—Ä—ã–º
                    }
                    return aMonth - bMonth; // –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Å—è—Ü—ã –ø–æ –ø–æ—Ä—è–¥–∫—É
                }
                
                return 0;
            });
            
            let html = '<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:</h3>';
            html += `<p><strong>–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞:</strong> ${currentYear}-${currentMonth}</p>`;
            html += `<p><strong>–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–¥–æ–≤:</strong> ${allTrends.length}</p>`;
            
            html += '<h4>–ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:</h4>';
            html += '<table><tr><th>‚Ññ</th><th>–î–∞—Ç–∞</th><th>–ì–æ–¥</th><th>–ú–µ—Å—è—Ü</th><th>–¢–∏–ø</th><th>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</th><th>–¶–µ–Ω–∞ –∞—Ä–µ–Ω–¥—ã</th></tr>';
            
            allTrends.forEach((trend, index) => {
                const rowClass = trend.type === 'historical' ? 'historical' : 
                               trend.type === 'current' ? 'current' : 'future';
                
                html += `<tr class="${rowClass}">
                    <td>${index + 1}</td>
                    <td>${trend.date}</td>
                    <td>${trend.property_year}</td>
                    <td>${trend.property_month}</td>
                    <td>${trend.type === 'historical' ? '–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π' : 
                          trend.type === 'current' ? '–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü' : '–ë—É–¥—É—â–∏–π'}</td>
                    <td>${trend.unit_price_for_sale.toLocaleString('ru-RU')} ‚Ç∫</td>
                    <td>${trend.unit_price_for_rent.toLocaleString('ru-RU')} ‚Ç∫</td>
                </tr>`;
            });
            
            html += '</table>';
            
            html += '<h4>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏:</h4>';
            html += '<ul>';
            html += `<li>‚úÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–Ω–¥—ã: ${historicalTrends.length} (–æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏, –Ω–æ–≤—ã–µ –≥–æ–¥—ã —Å–Ω–∞—á–∞–ª–∞)</li>`;
            html += `<li>‚úÖ –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü: ${currentMonthTrends.length} (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ)</li>`;
            html += `<li>‚úÖ –ë—É–¥—É—â–∏–µ —Ç—Ä–µ–Ω–¥—ã: ${futureTrends.length} (–æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏, —Å—Ç–∞—Ä—ã–µ –≥–æ–¥—ã —Å–Ω–∞—á–∞–ª–∞)</li>`;
            html += '</ul>';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ—Ä—è–¥–∫–∞
            const firstTrend = allTrends[0];
            const lastTrend = allTrends[allTrends.length - 1];
            
            if (firstTrend.type === 'historical' && lastTrend.type === 'future') {
                html += '<p class="success">‚úÖ –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω: –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ ‚Üí –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü ‚Üí –ë—É–¥—É—â–∏–µ</p>';
            } else {
                html += '<p class="error">‚ùå –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω</p>';
            }
            
            result.innerHTML = html;
        }
    </script>
</body>
</html>
