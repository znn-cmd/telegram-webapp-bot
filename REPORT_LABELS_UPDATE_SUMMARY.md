# Обновление меток отчетов и улучшение UX

## Выполненные изменения

### 1. Обновлены метки показателей

#### Цены аренды:
- ✅ "Средняя цена аренды" → "Средняя цена аренды, м²"
- ✅ "Минимальная цена аренды" → "Минимальная цена аренды, м²"
- ✅ "Максимальная цена аренды" → "Максимальная цена аренды, м²"

#### Площади:
- ✅ "Сопоставимая площадь для аренды" → "Средняя площадь аренды"

#### Цены продажи и аренды:
- ✅ "Цена для продажи" → "Цена для продажи, средняя"
- ✅ "Цена аренды" → "Цена для аренды, средняя"

#### Возраст объектов:
- ✅ "Средний возраст для продажи" → "Средний возраст объекта для продажи"
- ✅ "Средний возраст для аренды" → "Средний возраст объекта для аренды"

### 2. Удалены нежелательные показатели

Удалены следующие показатели из всех разделов отчета:
- ❌ "Изменение цены продажи: None%"
- ❌ "Изменение цены аренды: None%"
- ❌ "Изменение запасов продажи: None%"
- ❌ "Изменение запасов аренды: None%"
- ❌ "Коэффициент запасов продажи: 0.03"
- ❌ "Коэффициент запасов аренды: 0.01"
- ❌ "Количество объектов: None"

### 3. Административная дата тренда

- ✅ "Дата тренда" теперь отображается только для пользователей со статусом "admin"
- ✅ Добавлена проверка статуса администратора в функции `api_generate_report`
- ✅ Установлен флаг `format_simple_report.is_admin` для контроля отображения

### 4. Улучшения UX

- ✅ Отчет стал более чистым и сфокусированным
- ✅ Обычные пользователи видят только релевантные показатели
- ✅ Администраторы получают дополнительные технические детали
- ✅ Убраны пустые или неинформативные показатели

## Обновленные разделы

Все следующие разделы были обновлены:
- Общие данные рынка
- Тренд по количеству спален
- Тренд по возрасту объекта
- Тренд по этажу объекта
- Тренд по типу отопления

## Техническая реализация

### Проверка статуса администратора
```python
# Проверяем статус администратора
is_admin = False
if telegram_id:
    try:
        user_result = supabase.table('users').select('user_status').eq('telegram_id', telegram_id).execute()
        if user_result.data and user_result.data[0].get('user_status') == 'admin':
            is_admin = True
            logger.info(f"✅ Пользователь {telegram_id} имеет статус администратора")
    except Exception as e:
        logger.error(f"Ошибка проверки статуса администратора: {e}")

# Устанавливаем флаг администратора для функции форматирования
format_simple_report.is_admin = is_admin
```

### Условное отображение даты тренда
```python
# Добавляем дату тренда только для администраторов
if hasattr(format_simple_report, 'is_admin') and format_simple_report.is_admin:
    report_lines.append(f"Дата тренда: {general.get('trend_date', 'н/д')}")
    report_lines.append("")
```

## Результат

Отчет теперь:
1. Более информативен и понятен для пользователей
2. Содержит только релевантные показатели
3. Предоставляет администраторам дополнительную техническую информацию
4. Имеет улучшенный пользовательский опыт

