# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis –¥–ª—è Amvera

## –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –í–Ω–µ—à–Ω–∏–π Redis —Å–µ—Ä–≤–∏—Å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

#### **1.1 –ò—Å–ø–æ–ª—å–∑—É–µ–º Redis Cloud (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)**

1. **–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—Å—è –Ω–∞ [Redis Cloud](https://redis.com/redis-enterprise-cloud/overview/)**
2. **–°–æ–∑–¥–∞–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
3. **–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   - Host: `redis-xxxxx.c1.us-east-1-1.ec2.cloud.redislabs.com`
   - Port: `12345`
   - Password: `your_password`

#### **1.2 –û–±–Ω–æ–≤–ª—è–µ–º amvera.yaml**

```yaml
env:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ...
  - name: REDIS_HOST
    value: redis-xxxxx.c1.us-east-1-1.ec2.cloud.redislabs.com
  - name: REDIS_PORT
    value: "12345"
  - name: REDIS_DB
    value: "0"
  - name: REDIS_PASSWORD
    value: your_redis_password
  - name: CACHE_TTL_HOURS
    value: "24"
  - name: CACHE_ENABLED
    value: "true"
```

#### **1.3 –î–µ–ø–ª–æ–π –Ω–∞ Amvera**

```bash
# –î–µ–ø–ª–æ–∏–º —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º amvera.yaml
amvera deploy
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Redis –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**

#### **2.1 –ò—Å–ø–æ–ª—å–∑—É–µ–º Dockerfile —Å Redis**

1. **–°–æ–∑–¥–∞–µ–º `Dockerfile.amvera`** (—É–∂–µ —Å–æ–∑–¥–∞–Ω)
2. **–°–æ–∑–¥–∞–µ–º `supervisord.conf`** (—É–∂–µ —Å–æ–∑–¥–∞–Ω)
3. **–û–±–Ω–æ–≤–ª—è–µ–º amvera.yaml:**

```yaml
build:
  dockerfile: Dockerfile.amvera

env:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ...
  - name: REDIS_HOST
    value: "localhost"
  - name: REDIS_PORT
    value: "6379"
  - name: REDIS_DB
    value: "0"
  - name: CACHE_ENABLED
    value: "true"
```

#### **2.2 –î–µ–ø–ª–æ–π**

```bash
amvera deploy
```

### **–í–∞—Ä–∏–∞–Ω—Ç 3: Fallback –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ë–µ–∑ Redis)**

#### **3.1 –û—Ç–∫–ª—é—á–∞–µ–º Redis**

```yaml
env:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ...
  - name: CACHE_ENABLED
    value: "true"
  # Redis –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –Ω—É–∂–Ω—ã
```

#### **3.2 –ò—Å–ø–æ–ª—å–∑—É–µ–º in-memory –∫—ç—à**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ in-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ö—ç—à —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –î–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)

### **–®–∞–≥ 1: –í—ã–±–∏—Ä–∞–µ–º Redis Cloud**

1. **–ò–¥–µ–º –Ω–∞ [Redis Cloud](https://redis.com/redis-enterprise-cloud/overview/)**
2. **–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—Å—è**
3. **–°–æ–∑–¥–∞–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
4. **–ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

### **–®–∞–≥ 2: –û–±–Ω–æ–≤–ª—è–µ–º amvera.yaml**

```yaml
name: telegram-webapp-bot
runtime: python
version: "3.11"

build:
  commands:
    - chmod +x install-packages.sh
    - ./install-packages.sh

run:
  command: python app.py
  port: 8080

env:
  - name: TELEGRAM_BOT_TOKEN
    value: your_telegram_bot_token
  - name: SUPABASE_URL
    value: your_supabase_url
  - name: SUPABASE_ANON_KEY
    value: your_supabase_key
  # Redis –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  - name: REDIS_HOST
    value: your_redis_host
  - name: REDIS_PORT
    value: "6379"
  - name: REDIS_DB
    value: "0"
  - name: REDIS_PASSWORD
    value: your_redis_password
  - name: CACHE_TTL_HOURS
    value: "24"
  - name: CACHE_ENABLED
    value: "true"

resources:
  memory: 512Mi
  cpu: 250m
```

### **–®–∞–≥ 3: –î–µ–ø–ª–æ–π**

```bash
# –î–µ–ø–ª–æ–∏–º –Ω–∞ Amvera
amvera deploy

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
amvera logs
```

### **–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**

1. **–û—Ç–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
2. **–ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–û—Ü–µ–Ω–∫–∞ –æ–±—ä–µ–∫—Ç–∞"**
3. **–í –ª–æ–≥–∞—Ö –∏—â–µ–º:**
   ```
   ‚úÖ Redis —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
   üöÄ –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ –∫—ç—à–∞
   ```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### **–° Redis Cloud:**
- **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: 2-3 —Å–µ–∫—É–Ω–¥—ã
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏**: 0.01-0.05 —Å–µ–∫—É–Ω–¥
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: –≤ 100-300 —Ä–∞–∑

### **–° in-memory –∫—ç—à–µ–º:**
- **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: 2-3 —Å–µ–∫—É–Ω–¥—ã
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏**: 0.01-0.05 —Å–µ–∫—É–Ω–¥
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: –≤ 50-100 —Ä–∞–∑
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: –∫—ç—à —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞**

```bash
# –ß–µ—Ä–µ–∑ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
curl https://your-app.amvera.app/api/cache/stats

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
curl -X POST https://your-app.amvera.app/api/cache/clear
```

### **–õ–æ–≥–∏ Amvera**

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
amvera logs

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫—ç—à—É
amvera logs | grep -E "(Redis|cache|–∫—ç—à)"
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### **Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**

```
‚ö†Ô∏è Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: Connection refused. –ò—Å–ø–æ–ª—å–∑—É–µ–º in-memory –∫—ç—à.
```

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ amvera.yaml

### **–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞**

```
üì° –ö—ç—à –ø—É—Å—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
```

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∏–∑ –∫—ç—à–∞.

### **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

```
‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis: timeout
```

**–†–µ—à–µ–Ω–∏–µ**: 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–∞ –∏ –ø–æ—Ä—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Redis —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis Cloud –∏–ª–∏ –¥—Ä—É–≥–æ–π –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫—ç—à–∞
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ in-memory –∫—ç—à (CACHE_ENABLED=true, –±–µ–∑ Redis)
- –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π Redis –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –£–≤–µ–ª–∏—á—å—Ç–µ TTL –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (24-48 —á–∞—Å–æ–≤)
- –£–º–µ–Ω—å—à–∏—Ç–µ TTL –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (1-6 —á–∞—Å–æ–≤)

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ 10-50 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º! üéâ
