# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSL timeout –∏ –ø—Ä–æ–±–ª–µ–º —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ Aaadviser

## üö® –ü—Ä–æ–±–ª–µ–º—ã

1. **SSL timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ Supabase**:
   ```
   _ssl.c:999: The handshake operation timed out
   ```

2. **404 –æ—à–∏–±–∫–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤**:
   ```
   GET /i18n-manager.js HTTP/1.1" 404
   ```

3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î**:
   - –ü—Ä–∏ SSL timeout –∫—ç—à –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç 500 –æ—à–∏–±–∫—É –≤–º–µ—Å—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ SSL timeout –≤ connection_pool.py**:

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏)
- ‚úÖ –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ SSL handshake –æ—à–∏–±–æ–∫
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# Retry –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
for attempt in range(max_retries):
    try:
        result = query_func(*args, **kwargs)
        return result
    except Exception as e:
        if "timeout" in str(e).lower() or "handshake" in str(e).lower():
            if attempt < max_retries - 1:
                time.sleep(retry_delay)
                retry_delay *= 2  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
                continue
        raise e
```

### 2. **–£–ª—É—á—à–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ /api/user endpoint**:

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ –∫—ç—à –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ SSL timeout
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `source: 'cache_fallback'` –≤ –æ—Ç–≤–µ—Ç

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
except Exception as e:
    logger.error(f"Database connection error: {e}")
    # –ï—Å–ª–∏ –µ—Å—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –∫–∞–∫ fallback
    if cache_manager:
        cached_user = cache_manager.get_user_data(telegram_id)
        if cached_user:
            return jsonify({
                'exists': True,
                'source': 'cache_fallback',
                # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            })
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω route –¥–ª—è i18n-manager.js**:

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω endpoint `/i18n-manager.js`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ 404 –æ—à–∏–±–∫–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
@app.route('/i18n-manager.js')
def serve_i18n_manager():
    """–°–µ—Ä–≤–∏—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"""
    return send_from_directory('.', 'i18n-manager.js')
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ SSL timeout –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ë–î
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Å–µ—Ç—å—é

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å Supabase
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ –≤–º–µ—Å—Ç–æ –æ—à–∏–±–æ–∫
- ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö (cache/database/cache_fallback)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ retry –ø–æ–ø—ã—Ç–æ–∫

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–¢–µ—Å—Ç SSL timeout**:
   ```bash
   # –°–∏–º—É–ª–∏—Ä—É–π—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ retry –ª–æ–≥–∏–∫—É
   ```

2. **–¢–µ—Å—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**:
   ```bash
   # –û—Ç–∫–ª—é—á–∏—Ç–µ Supabase –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ fallback –Ω–∞ –∫—ç—à
   ```

3. **–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤**:
   ```bash
   curl http://your-domain/i18n-manager.js
   # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK
   ```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ retry –ø–æ–ø—ã—Ç–æ–∫
2. **–ö—ç—à**: –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–°–µ—Ç—å**: –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å Supabase

---
**–°—Ç–∞—Ç—É—Å**: ‚úÖ SSL timeout –∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
