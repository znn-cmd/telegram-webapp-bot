# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤

## üèóÔ∏è –ù–æ–≤–∞—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:
```
reports/
‚îú‚îÄ‚îÄ {telegram_id}/           # –ü–∞–ø–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ {report_folder_id}/  # –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –æ—Ç—á–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {report_id}.html # HTML —Ñ–∞–π–ª –æ—Ç—á–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ photos/          # –ü–∞–ø–∫–∞ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ property_1.jpg
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ property_2.png
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ {–¥—Ä—É–≥–æ–π_report_id}/
‚îÇ       ‚îú‚îÄ‚îÄ {report_id}.html
‚îÇ       ‚îî‚îÄ‚îÄ photos/
‚îî‚îÄ‚îÄ {–¥—Ä—É–≥–æ–π_telegram_id}/
    ‚îî‚îÄ‚îÄ ...
```

### –ü—Ä–∏–º–µ—Ä:
```
reports/
‚îú‚îÄ‚îÄ 123456789/              # telegram_id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ 847392058473/       # ID –æ—Ç—á–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 847392058473.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ photos/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ property_1.jpg
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ property_2.png
‚îÇ   ‚îî‚îÄ‚îÄ 592847362849/
‚îÇ       ‚îú‚îÄ‚îÄ 592847362849.html
‚îÇ       ‚îî‚îÄ‚îÄ photos/
‚îî‚îÄ‚îÄ 987654321/
    ‚îî‚îÄ‚îÄ 384756293847/
        ‚îú‚îÄ‚îÄ 384756293847.html
        ‚îî‚îÄ‚îÄ photos/
```

## üîó API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –î–æ—Å—Ç—É–ø –∫ –æ—Ç—á–µ—Ç–∞–º
```
GET /reports/{telegram_id}/{report_id}/{filename}
```
**–ü—Ä–∏–º–µ—Ä:** `/reports/123456789/847392058473/847392058473.html`

### 2. –î–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º –æ—Ç—á–µ—Ç–∞
```
GET /reports/{telegram_id}/{report_id}/photos/{photo_filename}
```
**–ü—Ä–∏–º–µ—Ä:** `/reports/123456789/847392058473/photos/property_1.jpg`

### 3. Legacy –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
```
GET /reports/{filename}
```
**–ü—Ä–∏–º–µ—Ä:** `/reports/847392058473.html` (–¥–ª—è —Å—Ç–∞—Ä—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –≤ –∫–æ—Ä–Ω–µ –ø–∞–ø–∫–∏ reports)

## ‚öôÔ∏è –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫
```python
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ—Ç—á–µ—Ç–∞
report_folder_id = ''.join(random.choices(string.digits, k=12))

# –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
user_reports_dir = os.path.join('reports', str(telegram_id))
report_dir = os.path.join(user_reports_dir, report_folder_id)
os.makedirs(report_dir, exist_ok=True)

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –æ—Ç—á–µ—Ç–∞
filename = f"{report_folder_id}.html"
file_path = os.path.join(report_dir, filename)

# –ü–∞–ø–∫–∞ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
photos_dir = os.path.join(report_dir, 'photos')
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
```python
if property_info.get('photos'):
    # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
    os.makedirs(photos_dir, exist_ok=True)
    
    for i, photo in enumerate(property_info['photos']):
        # –î–µ–∫–æ–¥–∏—Ä—É–µ–º base64 –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
        photo_filename = f"property_{i+1}.jpg"
        photo_path = os.path.join(photos_dir, photo_filename)
        # ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è URL
```python
# URL –æ—Ç—á–µ—Ç–∞
report_url = f"/reports/{telegram_id}/{report_folder_id}/{filename}"

# URL –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
verification_url = f"{host}/reports/{telegram_id}/{report_folder_id}/{filename}"
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- **–ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ—é –ø–∞–ø–∫—É
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç—á–µ—Ç–æ–≤:** –ö–∞–∂–¥—ã–π –æ—Ç—á–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤:** –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –æ—Ç—á–µ—Ç–æ–º

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞:** –õ–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ telegram_id
- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –§–∞–π–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è

### ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–ø–∫–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç—á–µ—Ç–∞–º–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–û—á–∏—Å—Ç–∫–∞:** –ü—Ä–æ—Å—Ç–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### ‚úÖ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:** –õ–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±—ç–∫–∞–ø—ã –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã

## üîß –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **Legacy –ø–æ–¥–¥–µ—Ä–∂–∫–∞:** –°—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —á–µ—Ä–µ–∑ `/reports/{filename}`
- **–ú–∏–≥—Ä–∞—Ü–∏—è:** –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Å—ã–ª–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```bash
# –†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
du -sh reports/{telegram_id}/

# –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –æ—Ç—á–µ—Ç–æ–≤
du -sh reports/

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
find reports/{telegram_id}/ -name "*.html" | wc -l
```
