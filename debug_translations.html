<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>–¢–µ—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤ - –û—Ç–ª–∞–¥–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="i18n-manager.js?v=1.1"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-item { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .key { font-weight: bold; color: #333; }
        .result { color: #666; }
        .error { color: red; }
        .success { color: green; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h1>
    
    <div class="test-item">
        <div class="key">main.title:</div>
        <div class="result" id="main-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div class="test-item">
        <div class="key">reports.region_analytics:</div>
        <div class="result" id="reports-region_analytics">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div class="test-item">
        <div class="key">reports.property_evaluation:</div>
        <div class="result" id="reports-property_evaluation">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div class="test-item">
        <div class="key">reports.title:</div>
        <div class="result" id="reports-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div class="test-item">
        <div class="key">profile.title:</div>
        <div class="result" id="profile-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <div class="test-item">
        <div class="key">common.help:</div>
        <div class="result" id="common-help">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    
    <button onclick="testTranslations()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç</button>
    <button onclick="checkConsole()">üìã –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å</button>
    <button onclick="forceUpdate()">‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
    
    <div id="debug-info"></div>

    <script>
        // –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ i18nManager
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∂–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ i18nManager...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 100–º—Å, –≥–æ—Ç–æ–≤ –ª–∏ i18nManager
            const checkInterval = setInterval(() => {
                if (window.i18nManager && window.i18nManager.translations) {
                    console.log('‚úÖ i18nManager –≥–æ—Ç–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç...');
                    clearInterval(checkInterval);
                    testTranslations();
                }
            }, 100);
            
            // –¢–∞–π–º–∞—É—Ç –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫
            setTimeout(() => {
                clearInterval(checkInterval);
                console.log('‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è i18nManager, –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç...');
                testTranslations();
            }, 5000);
        });
        
        function testTranslations() {
            console.log('üß™ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤...');
            
            const keys = [
                'main.title',
                'reports.region_analytics',
                'reports.property_evaluation',
                'reports.title',
                'profile.title',
                'common.help'
            ];
            
            keys.forEach(key => {
                const elementId = key.replace(/\./g, '-');
                const element = document.getElementById(elementId);
                const translation = i18nManager.getTranslation(key);
                
                console.log(`  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–∞: ${key} ‚Üí ${translation}`);
                console.log(`    üîç –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å ID: ${elementId}`);
                
                if (element) {
                    element.textContent = translation;
                    element.className = translation === key ? 'error' : 'success';
                    console.log(`    ‚úÖ –≠–ª–µ–º–µ–Ω—Ç ${elementId} –æ–±–Ω–æ–≤–ª–µ–Ω: ${element.textContent}`);
                } else {
                    console.error(`    ‚ùå –≠–ª–µ–º–µ–Ω—Ç ${elementId} –Ω–µ –Ω–∞–π–¥–µ–Ω!`);
                    console.log(`    üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:`);
                    document.querySelectorAll('[id]').forEach(el => {
                        console.log(`      - ${el.id}`);
                    });
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            const debugInfo = document.getElementById('debug-info');
            debugInfo.innerHTML = `
                <h3>üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h3>
                <p><strong>–¢–µ–∫—É—â–∏–π —è–∑—ã–∫:</strong> ${i18nManager.currentLanguage}</p>
                <p><strong>–ü–µ—Ä–µ–≤–æ–¥—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:</strong> ${Object.keys(i18nManager.translations).join(', ')}</p>
                <p><strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è ru:</strong> ${Object.keys(i18nManager.translations.ru || {}).join(', ')}</p>
                <p><strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è reports:</strong> ${Object.keys(i18nManager.translations.ru?.reports || {}).join(', ')}</p>
                <p><strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è main:</strong> ${Object.keys(i18nManager.translations.ru?.main || {}).join(', ')}</p>
                <p><strong>–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</strong> ${Array.from(document.querySelectorAll('[id]')).map(el => el.id).join(', ')}</p>
            `;
        }
        
        function checkConsole() {
            alert('–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏');
        }
        
        function forceUpdate() {
            console.log('‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ...');
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º i18nManager
            if (window.i18nManager) {
                window.i18nManager.loadFallbackTranslations();
                console.log('‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            testTranslations();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
            setTimeout(() => {
                console.log('üîÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ...');
                testTranslations();
            }, 100);
        }
    </script>
</body>
</html>
