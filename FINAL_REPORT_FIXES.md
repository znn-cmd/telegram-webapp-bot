# üó∫Ô∏èüì∏ –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤

## üéØ –¶–µ–ª—å
–ü—Ä–∏–≤–µ—Å—Ç–∏ –æ—Ç—á–µ—Ç—ã –∫ –≤–∏–¥—É –∫–∞–∫ –≤ `sample.htm`:
- –ö–∞—Ä—Ç–∞ —á–µ—Ä–µ–∑ OpenStreetMap —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –≤ –∫–∞—Ä—É—Å–µ–ª–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ –ø–∞–ø–∫–µ –æ—Ç—á–µ—Ç–∞

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. üó∫Ô∏è –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –±–ª–æ–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

#### –î–æ–±–∞–≤–ª–µ–Ω–æ:
```html
<div class="info-item">
    <span class="info-label">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</span>
    <span class="info-value">{latitude}, {longitude}</span>
</div>
```

#### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–æ–∫–∞—Ü–∏–∏"
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç—ã OpenStreetMap
- –í–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏

### 2. üìù –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

#### –î–æ–±–∞–≤–ª–µ–Ω–æ:
```python
logger.info(f"Processing {len(property_info['photos'])} photos for report")
logger.info(f"Created photos directory: {photos_dir}")
logger.info(f"Saved photo: {photo_path} ({len(image_data)} bytes)")
logger.info(f"Successfully saved {len(saved_photos)} photos")
```

#### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –õ–µ–≥—á–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

### 3. üîÑ –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

#### –õ–æ–≥–∏–∫–∞:
1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `photos/`
2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2**: Base64 –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
3. **Fallback**: –ó–∞–≥–ª—É—à–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

#### –ö–æ–¥:
```python
if saved_photos:
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
    for i, photo in enumerate(saved_photos):
        photos_slides += f'<img src="{photo['path']}" alt="{photo['name']}">'
elif property_info.get('photos'):
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º base64 –¥–∞–Ω–Ω—ã–µ
    for i, photo in enumerate(property_info['photos']):
        photos_slides += f'<img src="{photo.get('data', '')}" alt="–§–æ—Ç–æ –æ–±—ä–µ–∫—Ç–∞ {i+1}">'
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –ù–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:
```
reports/
‚îú‚îÄ‚îÄ {telegram_id}/              # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
‚îÇ   ‚îú‚îÄ‚îÄ {report_folder_id}/     # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ—Ç—á–µ—Ç–∞ (12 —Ü–∏—Ñ—Ä)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {report_id}.html    # HTML —Ñ–∞–π–ª –æ—Ç—á–µ—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ photos/             # –ü–∞–ø–∫–∞ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –æ–±—ä–µ–∫—Ç–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ property_1.jpg
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ property_2.png
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ {–¥—Ä—É–≥–æ–π_report_id}/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ {–¥—Ä—É–≥–æ–π_telegram_id}/
    ‚îî‚îÄ‚îÄ ...
```

### Legacy –æ—Ç—á–µ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è:
```
reports/
‚îú‚îÄ‚îÄ 1.html                     # –°—Ç–∞—Ä—ã–µ –æ—Ç—á–µ—Ç—ã
‚îú‚îÄ‚îÄ 1_files/                   # –ü–∞–ø–∫–∏ —Å–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ chart.js
‚îÇ   ‚îî‚îÄ‚îÄ avatar_*.png
‚îî‚îÄ‚îÄ ...
```

## üîó API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –î–ª—è –Ω–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤:
- **HTML**: `/reports/{telegram_id}/{report_id}/{filename}`
- **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏**: `/reports/{telegram_id}/{report_id}/photos/{photo_filename}`

### –î–ª—è —Å—Ç–∞—Ä—ã—Ö –æ—Ç—á–µ—Ç–æ–≤:
- **Legacy**: `/reports/{filename}`

## üß™ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞** —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –æ–±—ä–µ–∫—Ç–∞
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π** –≤ –ø–∞–ø–∫—É `photos/`
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã** —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
4. **–†–∞–±–æ—Ç–∞ –∫–∞—Ä—É—Å–µ–ª–∏** —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
5. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫** `{telegram_id}/{report_id}/`

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç—á–µ—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –î–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ–±—ä–µ–∫—Ç–∞
3. –£–∫–∞–∂–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –æ—Ç—á–µ—Ç
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –°–æ–∑–¥–∞–ª–∞—Å—å –ª–∏ –ø–∞–ø–∫–∞ `reports/{telegram_id}/{report_id}/`
   - –°–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –ª–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ `photos/`
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ª–∏ –∫–∞—Ä—Ç–∞ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
   - –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –∫–∞—Ä—É—Å–µ–ª—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á–µ—Ç—ã –¥–æ–ª–∂–Ω—ã:
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É —Å —Ç–æ—á–Ω—ã–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–∞—Ä—É—Å–µ–ª—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –æ–±—ä–µ–∫—Ç–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- ‚úÖ –†–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ `sample.htm`

**–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üöÄ
